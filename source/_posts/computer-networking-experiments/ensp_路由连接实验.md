---
title: 使用ensp进行简单的路由器互连实验
author: rovo98
date: 2018/6/7
categories: 计算机网络
tags: 路由器
abbrlink: cc46ce96
---

![](/images/ensp_路由连接实验/route-structure.png)

使用ensp做华为AR1220路由进行简单的互连实验。

<!-- more -->

### 实验内容

- 路由器设置
- 手动设置静态路由

### 实验环境

- 华为路由器AR1220
- 主机
- Serial设备连接串口线和Copper以太网和千兆以太网连接线

备注：所有实验设备均由**ensp**模拟。

#### 路由连接实验设计

整体设计结构如下：

- 1.其中分为六个不同的局域网；

```txt
192.168.11.0 网段 ->
    主机:   192.168.11.11
            192.168.11.12
    路由器AR6一个GigabitEthernet接口作为该网段的默认网关(192.168.11.1)

192.168.12.0 网段 ->
    主机:   192.168.12.11
            192.168.12.12
    路由器AR4的一个GigabitEthernet接口作为该网段的默认网关(192.168.12.1)

192.168.13.0 网段 ->
    主机:    192.168.13.11
            192.168.13.12
            192.168.13.13
   路由器AR7的一个GigabitEthernet接口作为该网段的默认网关(192.168.13.1)
   
1.1.2.0 网段 -> 路由器AR6和路由器AR7之间的接口
1.1.1.0 网段 -> 路由器AR6和AR4之间的接口
1.1.3.0 网段 -> 路由器AR6和AR7之间的接口
```

- 2.设备的连接：

> 除了路由器之间连接使用serial串口连接线外，其他均使用Copper连接线。

### 实验步骤

#### 配置各个局域网的ip及其网关

- 例如：``192.168.11.0``网段下的``192.168.11.11``主机：

![PC1](pc1_setting.jpg)

- 配置 ``192.168.11.1``作为``192.168.11.0``网段的网关：

![设置网关](gateway1.png)

所有主机经过配置后，他们应该可以ping通自己网段下的所有主机，如：``192.168.11.12`` ping ``192.168.11.11``

![局域网ping测试](pingTest.jpg)

**[需要注意的是]**： 由于路由器互连时使用的是serial串口，所以路由器之间配置的是serial串口的ip。

例如：配置AR6的两个serial串口的接口ip为：``1.1.1.1``和``1.1.2.1``：

```txt
<Huawei> system-view
[Huawei] inter serial 2/0/1
[Huawei-Servial2/0/1] ip address 1.1.1.1 255.255.255.0
[Huawei-Servial2/0/1] quit
[Huawei] inter serial 2/0/0
[Huawei-Serial2/0/0] ip address 1.1.2.1 255.255.255.0
```

#### 各个路由器的静态路由：

对于路由器AR6,我们希望所有**目的网络**为``192.168.12.0``的数据包都交付给AR4,即下一跳为``1.1.1.2``;所有目的网络为``192.168.13.0``的都交给AR7,下一跳为``1.1.2.2``：

```txt
<Huawei> system-view
[Huawei] ip route-static 192.168.12.0 255.255.255.0 1.1.1.2
[Huawei] ip route-static 192.168.13.0 255.255.255.0 1.1.2.2
```

对于路由器AR4，所有目的网络为``192.168.11.0``的数据包交给AR6，下一跳为：``1.1.1.1``，目的网络为``192.168.13.0``的数据包交给AR7，下一跳为：``1.1.3.1``：

```txt
<Huawei> system-view
[Huawei] ip route-static 192.168.11.0 255.255.255.0 1.1.1.1
[Huawei] ip route-static 192.168.13.0 255.255.255.0 1.1.3.1
```

对于路由器AR7， 所有目的网络为``192.168.11.0``的数据包都交给AR6，下一跳为：``1.1.2.1``，所有目的网络为``192.168.12.0``的数据包都交给AR4，下一跳为：``1.1.3.2``：

```txt
<Huawei> system-view
[Huawei] ip route-static 192.168.11.0 255.255.255.0 1.1.2.1
[Huawei] ip route-static 192.168.12.0 255.255.255.0 1.1.3.2
```

经过以上对各个路由器的静态路由的配置后，我们可以通过
```txt
display ip routing-table
```
来查看各个路由器的路由表：

- AR6路由表：

![AR6路由表](route1_info.jpg)

- AR4路由表：

![AR4路由表](route2_info.jpg)

- AR7路由表：

![AR7路由表](route3_info.jpg)

### 测试实验结果

使用任意一个局域网下的主机ping不同局域网下的主机：

``192.168.11.11`` ping ``192.168.13.12`` 和 ``192.168.12.12``:

![tracert测试1](tracert1.jpg)

``192.168.12.11`` ping ``192.168.11.12`` 和 ``192.168.13.13``:

![tracert测试2](tracert2.jpg)

``192.168.13.11`` ping ``192.168.11.11`` 和 ``192.168.12.11``：

![tracert测试3](tracert3.jpg)

由以上测试可以看出简单的路由器连接实验成功。

